# Проект "Веб-ларек"

## Описание проекта
"Веб-ларек" - это интернет-магазин, предназначенный для веб-разработчиков. Пользователи могут просматривать каталог товаров, добавлять их в корзину и оформлять заказы.

## Архитектура проекта
Проект реализован с использованием шаблона архитектуры Model-View-Presenter (MVP), который обеспечивает четкое разделение логики и представления. Это позволяет создать масштабируемое и легко поддерживаемое приложение.

"- **Model** - отвечает за бизнес-логику и данные приложения. Включает в себя работу с серверным API, обработку данных и их хранение.
- **View** - представляет пользовательский интерфейс приложения. Отвечает за отображение данных, полученных от Presenter, и взаимодействие с пользователем.
- **Presenter** - служит посредником между Model и View, обрабатывая действия пользователя, обновляя Model и обновляя View новыми данными."

### Стек технологий
- HTML & SCSS: Для создания структуры и стилей приложения.
- TypeScript: Обеспечивает типизацию и повышает надежность кода.
- Webpack: Служит для сборки модулей и оптимизации ресурсов.

### Структура проекта
```typescript
|   - `src/` — исходные файлы проекта.
|        |-- `components/` — компоненты приложения.
|           |--- `base/` — папка с базовым кодом

### Важные файлы:
│   - `src/`
│       |-- `pages/`
│           |--- `index.html` — HTML-файл главной страницы

│       |-- `types/`
│           |--- `index.ts` — файл с типами

│       |-- `index.ts` — точка входа приложения

│       |-- `styles/`
│           |--- `styles.scss` — корневой файл стилей

│       |-- `utils/`
│           |--- `constants.ts` — файл с константами
│           |--- `utils.ts` — файл с утилитами
```

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Об архитектуре

Взаимодействия в приложении основаны на событиях. Модели инициируют события, а в базовом коде слушатели выполняют передачу данных компонентам и вычисления, меняя состояние моделей.

# Базовый код

Проект "Веб-ларек" использует ряд базовых классов, обеспечивающих взаимодействие с сервером, управление событиями и создание компонентов.

## `class Api`

Класс `Api` предоставляет базовую функциональность для выполнения HTTP-запросов к серверу.

- **Конструктор:**
  - `baseUrl: string` — Базовый URL для доступа к API.
  - `options: RequestInit` — Настройки запроса.

- **Методы:**
  - `get(uri: string): Promise<object>` — Выполняет GET-запрос.
  - `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>` — Выполняет POST-запрос.
  - `handleResponse(response: Response): Promise<object>` — Обрабатывает ответ сервера.

- **Типы ответов:**
  ```typescript
  type ApiListResponse<Type> = {
      total: number,
      items: Type[]
  };

  type ApiOrderResponse<Type> = {
      total: number,
      id: string
  }

## `class EventEmitter`

Класс `EventEmitter` реализует паттерн "Наблюдатель", позволяя компонентам подписываться на события и реагировать на их выполнение.

- **Конструктор:**
  - Инициализирует хранилище событий.

- **Методы:**
  - `on` - Метод для подписки на событие в `EventEmitter`. 
  - `onAll(callback: (event: EmitterEvent) => void)` - Метод для подписки на все события в `EventEmitter`. Принимает функцию-обработчик.
  - `off(eventName: EventName, callback: Subscriber)` - Метод для отписки от события в `EventEmitter`.
  - `offAll(): void` - Метод для удаления всех обработчиков событий в `EventEmitter`.
  - `emit` - Метод для инициирования события в `EventEmitter`. 
  - `trigger` - Метод создает коллбек-триггер, который при вызове инициирует событие. 

## `class Component`
Класс `Component` является основой для всех компонентов UI проекта, обеспечивая методы для работы с DOM.

- **Конструктор:** 
  - Принимает DOM-элемент, служащий контейнером компонента.

- **Методы:**
Методы для управления классами, содержимым, доступностью элементов и их видимостью.
   - `render(data?: Partial<T>): HTMLElement` — Должен быть определен в производных классах для рендеринга компонента.

# Интерфейсы

В "Веб-лареке" определены ключевые интерфейсы, отражающие структуру данных приложения, что облегчает разработку и поддержку кода.

## `IAppState`

Описывает общее состояние приложения, включая каталог товаров, корзину пользователя и текущий заказ.

- **Свойства:**
  - `catalog: IProduct[]` — каталог всех доступных товаров.
  - `basket: IProduct[]` — товары, добавленные в корзину.
  - `order: IOrder | null` — информация о текущем заказе или `null`, если заказ отсутствует.

- **Методы:**
  - `setCatalog(items: IProduct[]): void` — обновляет каталог товаров.
  - `addToBasket(product: IProduct): void` — добавляет товар в корзину.
  - `removeFromBasket(product: IProduct): void` — удаляет товар из корзины.
  - `getTotalBasketPrice(): number` — вычисляет общую стоимость товаров в корзине.

## `IModal`

Интерфейс для модальных окон, управляющий отображением контента.

- **Свойства:**
  - `content: HTMLElement` — содержимое модального окна.

## `IProduct`

Определяет структуру данных товара в каталоге.

- **Свойства:**
  - `id: string` — уникальный идентификатор товара.
  - `image: string` — URL изображения товара.
  - `title: string` — название товара.
  - `category: string` — категория товара.
  - `price: number | null` — цена товара.
  - `description: string` — описание товара.
  - `selected: boolean` — статус выбранности товара.

## `IPage`

Интерфейс страницы, включая элементы управления и отображения содержимого.

- **Свойства:**
  - `counter: number` — счетчик товаров в корзине.
  - `catalog: HTMLElement[]` — карточки товаров.
  - `locked: boolean` — статус блокировки прокрутки страницы.

## `IBasket`

Описывает структуру корзины покупок.

- **Свойства:**
  - `list: HTMLElement[]` — список товаров в корзине.
  - `total: number` — общая стоимость товаров.

## `IProductInBasket extends IProduct`

Расширяет `IProduct`, добавляя порядковый номер товара в корзине.

- **Свойства:**
  - `index: number` — порядковый номер товара.

## `IOrder`

Описывает структуру заказа.

- **Свойства:**
  - `items: string[]` — идентификаторы товаров в заказе.
  - `payment: string` — выбранный способ оплаты.
  - `total: number` — общая сумма заказа.
  - `address: string` — адрес доставки.
  - `email: string` — email покупателя.
  - `phone: string` — телефон покупателя.

## `IContactsForm`

Интерфейс формы контактных данных.

- **Свойства:**
  - `phone: string` — телефон.
  - `email: string` — email.

## `IOrderForm`

Интерфейс формы оплаты заказа.

- **Свойства:**
  - `address: string` — адрес.
  - `payment: string` — способ оплаты.

## `IOrderResult`

Описывает результат успешного оформления заказа.

- **Свойства:**
  - `id: string` — идентификатор заказа.
  - `total: number` — сумма заказа.

## `IOrderValidate`

Интерфейс для валидации данных заказа.

- **Свойства:**
  - `phone: string` — телефон.
  - `email: string` — email.
  - `address: string` — адрес.
  - `payment: string` — способ оплаты.

## `ISuccessForm`

Интерфейс формы успешного оформления заказа.

- **Свойства:**
  - `description: number` — сумма списанных средств.

# Model (Модель)
Компоненты модели данных

## `class Product`
Класс `Product` является расширением базовой модели данных, реализованной через класс `Model`, и включает в себя свойства, определённые в интерфейсе `IProduct`. Этот класс служит для хранения и обработки информации о конкретном продукте в каталоге интернет-магазина. Вот основные атрибуты, которые он содержит:

  - `id: string;` - Уникальный идентификатор продукта в системе.
  - `description: string;` - Текстовое описание продукта, предоставляющее детальную информацию о его характеристиках.
  - `image: string;` - Ссылка на изображение продукта, позволяющая визуализировать его в интерфейсе пользователя.
  - `title: string;` - Название продукта, используемое в каталоге и при представлении продукта пользователю.
  - `category: string;` - Категория, к которой относится продукт, помогающая классифицировать продукт по типу.
  - `status: boolean;` - Статус наличия продукта в корзине пользователя, где `true` означает, что продукт добавлен в корзину.
  - `price: number;` - Цена продукта, указанная в условных единицах.

## `class AppState`
Класс `AppState`, расширяющий базовый класс `Model` и реализующий интерфейс `IAppState`, отвечает за хранение и управление общим состоянием приложения. В его основе лежат следующие поля, отражающие ключевые аспекты функциональности интернет-магазина:

  - `basket: Product[]` - Список продуктов, добавленных пользователем в корзину.
  - `catalog: Product[]` - Полный каталог доступных продуктов.
  - `order: IOrder` - Текущий заказ, включая выбранные товары и информацию для оформления.
  - `formErrors: FormErrors` - Сведения об ошибках, возникших при заполнении пользователем формы заказа.

- **Методы:**
  - `setCatalog(catalog: Product[])` - Обновляет каталог продуктов в состоянии приложения.
  - `addToBasket(product: Product)` - Добавляет указанный продукт в корзину.
  - `removeFromBasket(product: Product)` - Удаляет продукт из корзины.
  - `getTotalBasketPrice(): number` - Вычисляет и возвращает общую стоимость всех товаров в корзине.
  - `getEmptyOrder()` - Инициализирует заказ с пустыми полями, подготавливая форму заказа к новому вводу.
  - `getCountProductInBasket(): number` - Подсчитывает количество товаров, находящихся в корзине.
  - `setOrderFields(orderFields: IOrder)` - Задает значения для полей заказа.
  - `validateOrder(orderData: IOrder): boolean` - Проверяет, корректно ли заполнены поля формы заказа.
  - `validateContacts(contacts: IContactsForm): boolean` - Проверяет, корректно ли заполнены контактные данные пользователя.
  - `addProductsToOrder()` - Добавляет выбранные в корзине продукты в текущий заказ.
  - `clearBasket()` - Очищает корзину, удаляя из неё все продукты.
  - `resetSelected()` - Сбрасывает статус выбранности всех товаров, делая их снова доступными для добавления в корзину.
  - `clearOrder()` - Очищает все данные о текущем заказе, включая выбранные товары и информацию для оформления.

# View (Представление)
Компоненты представления

## `class Page`
Класс `Page` отвечает за отображение главной страницы интернет-магазина. Он наследуется от базового класса `Component` и реализует интерфейс `IPage`, предоставляя функциональность для динамического отображения каталога товаров и управления элементами UI, такими как счетчик товаров в корзине и блокировка страницы при взаимодействии с модальными окнами.

- **Основные поля:**
  - `counter: HTMLElement` - DOM-элемент счетчика товаров в корзине.
  - `catalog: HTMLElement` - DOM-элемент каталога товаров.
  - `wrapper: HTMLElement` - DOM-элемент обертки главной страницы.
  - `basket: HTMLElement` - DOM-элемент иконки корзины.

- **Конструктор:**
  - `container: HTMLElement` - Контейнер для всей страницы.
  - `events: IEvents` - Ссылка на менеджер событий.

- **Методы:**
  - `set counter(value: number)` - Устанавливает количество товаров на иконке корзины.
  - `set catalog(items: HTMLElement[])` - Отображает каталог товаров.
  - `set locked(value: boolean)` - Блокирует или разблокирует страницу при взаимодействии с модальными окнами.


## `class Card`
Класс `Card` — компонент для отображения информации о продукте в виде карточки. Он наследуется от `Component` и реализует интерфейс `IProduct`, обеспечивая отображение данных о продукте в галерее, на странице товара и в корзине.

- **Основные поля:**
  - `image: HTMLImageElement` - DOM-элемент изображения продукта.
  - `title: HTMLElement` - DOM-элемент названия продукта.
  - `category: HTMLElement` - DOM-элемент категории продукта.
  - `price: HTMLElement` - DOM-элемент цены продукта.
  - `description: HTMLElement` - DOM-элемент описания продукта.
  - `button?: HTMLButtonElement` - Опциональный DOM-элемент кнопки в карточке продукта.

- **Конструктор:**
  - `blockName: string` - Имя блока для стилизации.
  - `HTMLElement: HTMLElement` - DOM-элемент карточки товара.
  - `ICardActions` - Интерфейс действий с карточкой (например, добавление в корзину).

- **Методы:**
  - `set id(value: string)` - Устанавливает ID товара.
  - `set Image(url: string)` - Устанавливает картинку товара.
  - `set title(value: string)` - Устанавливает название товара.
  - `set category(value: string)` - Устанавливает категорию товара.
  - `set description(value: string)` - Устанавливает описание товара.
  - `set price(value: number)` - Устанавливает цену товара.
  - `set button(value: string)` - Устанавливает текст кнопки.
  - `set selected(value: boolean)` - Определяет, находится ли товар в корзине.
  - `updateButton(action: string)` - Обновляет состояние кнопки в зависимости от действия (добавление/удаление из       корзины).

## `class CardPreview`
Класс `CardPreview` расширяет функционал класса `Card`, предназначен для представления карточки товара в модальном окне. Этот класс добавляет специализированное поле для управления описанием продукта в контексте его подробного просмотра.

- **Основные поля:**
  - `description: HTMLElement` - DOM-элемент, содержащий описание товара.

- **Конструктор:**
  - `container: HTMLElement` - DOM-элемент, который служит контейнером для карточки товара.
  - `actions?: ICardActions` - Необязательные действия, которые могут быть применены к карточке товара.

- **Методы:**
  - `set description(value: string)` - Принимает строку и обновляет DOM-элемент описания товара, обеспечивая отображение актуальной информации о продукте в модальном окне.

## `class ProductItemBasket`
Класс `ProductItemBasket`, производный от базового `Component`, служит для представления отдельного товара в корзине пользователя. Этот класс визуализирует ключевые данные товара, такие как его название, стоимость, а также порядковый номер (индекс) в корзине, и предоставляет функционал для его удаления из корзины.

- **Основные поля:**
  - `index: HTMLElement` - DOM-элемент, отображающий порядковый номер товара в корзине.
  - `title: HTMLElement` - DOM-элемент, отображающий название товара.
  - `price: HTMLElement` - DOM-элемент, отображающий стоимость товара.
  - `button: HTMLButtonElement` - DOM-элемент кнопки, позволяющей удалить товар из корзины.

- **Конструктор:**
  - `blockName: string` - Имя CSS класса, используемое для стилизации компонента.
  - `container: HTMLElement` - DOM-элемент, служащий контейнером для компонента товара в корзине.

- **Методы:**
  - `set title(value: string)` - Обновляет текст DOM-элемента названия товара в корзине.
  - `set index(value: number)` - Обновляет текст DOM-элемента, указывающего порядковый номер товара в списке корзины.
  - `set price(value: number)` - Обновляет текст DOM-элемента стоимости товара, отражая его текущую цену.

## `class Basket`
Класс `Basket`, унаследованный от `Component` и реализующий `IBasket`, управляет взаимодействием с корзиной покупок. Этот класс позволяет отображать детализированную информацию о товарах в корзине, включая стоимость каждого товара, обеспечивает возможность их удаления и отражает общую сумму заказа.

- **Основные поля:**
  - `list: HTMLElement` - DOM-элемент, представляющий список товаров в корзине.
  - `total: HTMLElement` - DOM-элемент, отображающий общую стоимость всех товаров в корзине.
  - `button: HTMLButtonElement` - DOM-элемент кнопки для оформления заказа.

- **Конструктор:**
  - `blockName: string` - Имя блока для CSS стилизации.
  - `container: HTMLElement` - DOM-элемент, служащий контейнером для компонента корзины.
  - `events: IEvents` - Ссылка на менеджер событий, обеспечивающий взаимодействие с товарами в корзине.

- **Методы:**
  - `set total(value: number)` - Обновляет и отображает итоговую стоимость товаров в корзине.
  - `set list(items: HTMLElement[])` - Обновляет и отображает список товаров в корзине.
  - `toggleButton(state: boolean)` - Управляет доступностью кнопки "Оформить заказ", блокируя её при пустой корзине или разблокируя при наличии товаров.
  - `updateIndices()` - Пересчитывает и обновляет индексы товаров в корзине, обеспечивая корректное отображение порядковых номеров после добавления новых товаров или удаления существующих.

## `class Modal`
Класс `Modal` наследует функционал от `Component` и реализует интерфейс `IModal`, специализируясь на управлении модальными окнами в приложении. Этот класс облегчает создание и управление модальными окнами, позволяя легко интегрировать и отображать различное содержимое.

- **Основные поля:**
    - `closeButton: HTMLButtonElement` - DOM-элемент кнопки, которая закрывает модальное окно.
    - `content: HTMLElement` - DOM-элемент, отображающий содержимое модального окна.

- **Конструктор:**
  - `container: HTMLFormElement` - DOM-элемент, служащий контейнером для модального окна.
  - `events: IEvents` - Ссылка на менеджер событий, обеспечивающий взаимодействие с пользователем и другими компонентами приложения.

- **Методы:**
  - `set content(value: HTMLElement)` - Устанавливает содержимое модального окна, позволяя динамически изменять информацию, отображаемую пользователю.
  - `open()` - Открывает модальное окно, делая его видимым для пользователя.
  - `close()` - Закрывает модальное окно, скрывая его содержимое.
  - `render()` - Определяет внешний вид и структуру формы модального окна, готовя его к отображению.

## `class Form`
Класс `Form` унаследован от Component и реализует интерфейс `IFormState`, предназначен для управления формой заказа. Этот класс обеспечивает валидацию формы, обработку ввода данных пользователя и отображение сообщений об ошибках.

- **Основные поля:**
  - `submit: HTMLButtonElement` - DOM-элемент кнопки для отправки формы.
  - `errors: HTMLElement` - DOM-элемент для отображения ошибок валидации формы.

- **Конструктор:**
  - `container: HTMLFormElement` - DOM-элемент, который служит контейнером для формы.
  - `events: IEvents` - Ссылка на менеджер событий, который позволяет форме взаимодействовать с другими компонентами приложения.
- **Методы:**
  - `onInputChange(event: Event): void` - Обрабатывает изменения в полях формы, обновляя состояние и проверяя валидность данных.
  - `valid(): boolean` - Проверяет форму на валидность. Возвращает true, если все данные формы валидны, иначе false.
  - `displayErrors(errors: string[]): void` - Принимает массив строк с ошибками и отображает их в элементе errors.
  - `render(): void` - Определяет структуру и внешний вид формы, готовя её к показу пользователю.

## `class OrderForm`
Класс `OrderForm`, производный от Form и реализующий `IOrderForm`, специализирован для управления формой оплаты в процессе оформления заказа.

- **Основные поля:**
  - `card: HTMLButtonElement` - DOM-элемент, представляющий опцию оплаты заказа банковской картой.
  - `cash: HTMLButtonElement` - DOM-элемент, представляющий опцию оплаты заказа наличными при получении.
  - `address: HTMLInputElement` - DOM-элемент для ввода адреса доставки.

- **Конструктор:**
  - `blockName: string` - Имя блока для стилизации.
  - `container: HTMLElement` - DOM-элемент, служащий контейнером для формы оплаты.
  - `events: IEvents` - Ссылка на менеджер событий, обеспечивающий взаимодействие формы с остальной частью приложения.

- **Методы:**
  - `clear(): void` - Очищает все поля формы от введённой информации, подготавливая форму к новому использованию.

## `class ContactsForm`
Класс `ContactsForm`, наследующий функциональность от Form и дополняемый интерфейсом `IContactsForm`, специфически разработан для управления формой ввода контактных данных пользователя при оформлении заказа или регистрации на сайте.

- **Конструктор:**
  - `container: HTMLFormElement` - DOM-элемент, предназначенный для хранения и взаимодействия с формой контактных данных.
  - `events: IEvents` - Ссылка на систему управления событиями, позволяющая форме реагировать на действия пользователя и взаимодействовать с другими компонентами приложения.

- **Методы:**
  - `clear(): void` - Очищает все поля формы от ранее введенной информации, обеспечивая пользователю возможность начать заполнение формы с чистого листа без необходимости вручную удалять каждое поле.

## `class SuccessForm`
Класс `SuccessForm`, расширяющий базовый класс `Component`, служит для отображения формы подтверждения успешного оформления заказа. Этот класс предоставляет пользователю визуальное подтверждение об успешной покупке и предлагает дальнейшие действия.

- **Основные поля:**
  - `button: HTMLButtonElement` - DOM-элемент кнопки, призывающей пользователя к действию "За новыми покупками", что позволяет легко вернуться к шоппингу после оформления заказа.
  - `description: HTMLElement` - DOM-элемент, отображающий информацию о подтверждении заказа, включая общую стоимость.
- **Конструктор:**
  - `blockName: string` - Имя блока для CSS стилизации.
  - `container: HTMLElement` - DOM-элемент, содержащий форму подтверждения заказа.
  - `actions?: Function` - Необязательные действия, предоставляемые формой, например, функция, вызываемая при клике на кнопку "За новыми покупками".

- **Методы:**
  - `set description(value: string)` - Устанавливает текст с описанием заказа, включая его общую стоимость, предоставляя пользователю полезную информацию о совершенной покупке.

# Presenter (Презентер)
Презентер служит посредником между Моделью и Представлением, обрабатывая действия пользователя, передавая команды от Представления к Модели и обновляя Представление новыми данными от Модели. Презентер декапсулирует логику взаимодействия между Моделью и Представлением, что облегчает их независимое изменение и тестирование.